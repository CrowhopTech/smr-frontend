{"version":3,"file":"SMLVersionForm-8ac871ff.js","sources":["../../../../../src/lib/models/sml-versions.ts","../../../../../src/lib/components/sml-versions/SMLVersionForm.svelte"],"sourcesContent":["import * as zod from 'zod';\nimport type { VersionStabilities } from '$lib/generated';\n\nexport type SMLVersionData = {\n  version: string;\n  satisfactory_version: number;\n  bootstrap_version?: string;\n  stability: VersionStabilities;\n  link: string;\n  changelog: string;\n  date: string;\n};\n\nconst versionRegex =\n  /^(<=|<|>|>=|\\^)?(0|[1-9]\\d*)\\.(0|[1-9]\\d*)\\.(0|[1-9]\\d*)(?:-((?:0|[1-9]\\d*|\\d*[a-zA-Z-][0-9a-zA-Z-]*)(?:\\.(?:0|[1-9]\\d*|\\d*[a-zA-Z-][0-9a-zA-Z-]*))*))?(?:\\+([0-9a-zA-Z-]+(?:\\.[0-9a-zA-Z-]+)*))?$/;\n\nexport const smlVersionSchema = zod.object({\n  version: zod.string().regex(versionRegex),\n  satisfactory_version: zod.number(),\n  bootstrap_version: zod.string().regex(versionRegex),\n  stability: zod.string(),\n  link: zod.string().url(),\n  changelog: zod.string(),\n  date: zod.string()\n});\n","<script lang=\"ts\">\n  import { createForm } from 'felte';\n  import { validator } from '@felte/validator-zod';\n  import { svelteReporter, ValidationMessage } from '@felte/reporter-svelte';\n  import { trimNonSchema } from '$lib/utils/forms';\n  import { markdown } from '$lib/utils/markdown';\n  import type { SMLVersionData } from '$lib/models/sml-versions';\n  import { smlVersionSchema } from '$lib/models/sml-versions';\n  import Textfield from '@smui/textfield';\n  import Button from '@smui/button';\n  import { VersionStabilities } from '$lib/generated';\n  import Select, { Option } from '@smui/select';\n\n  export let onSubmit: (data: SMLVersionData) => void;\n  export let initialValues: SMLVersionData = {\n    link: '',\n    bootstrap_version: '',\n    date: '',\n    changelog: '',\n    satisfactory_version: 0,\n    stability: VersionStabilities.Alpha,\n    version: ''\n  };\n  export let submitText = 'Create';\n\n  const { form, data } = createForm<SMLVersionData>({\n    initialValues: initialValues,\n    extend: [validator, svelteReporter],\n    validateSchema: smlVersionSchema,\n    onSubmit: (data: SMLVersionData) => onSubmit(trimNonSchema(data, smlVersionSchema))\n  });\n\n  $: preview = ($data.changelog as string) || '';\n</script>\n\n<form use:form>\n  <div class=\"grid grid-flow-row gap-6\">\n    <div class=\"grid grid-flow-row gap-2\">\n      <Textfield bind:value={$data.version} label=\"Version\" required />\n      <ValidationMessage for=\"version\" let:messages={message}>\n        <span class=\"validation-message\">{message || ''}</span>\n      </ValidationMessage>\n    </div>\n\n    <div class=\"grid grid-flow-row gap-2\">\n      <Textfield bind:value={$data.satisfactory_version} label=\"Satisfactory Version\" required type=\"number\" />\n      <ValidationMessage for=\"satisfactory_version\" let:messages={message}>\n        <span class=\"validation-message\">{message || ''}</span>\n      </ValidationMessage>\n    </div>\n\n    <div class=\"grid grid-flow-row gap-2\">\n      <Textfield bind:value={$data.bootstrap_version} label=\"Bootstrap Version\" required />\n      <ValidationMessage for=\"bootstrap_version\" let:messages={message}>\n        <span class=\"validation-message\">{message || ''}</span>\n      </ValidationMessage>\n    </div>\n\n    <div class=\"grid grid-flow-row gap-2\">\n      <Select bind:value={$data.stability} label=\"Stability\">\n        <Option value=\"alpha\">Alpha</Option>\n        <Option value=\"beta\">Beta</Option>\n        <Option value=\"release\">Release</Option>\n      </Select>\n      <ValidationMessage for=\"stability\" let:messages={message}>\n        <span class=\"validation-message\">{message || ''}</span>\n      </ValidationMessage>\n    </div>\n\n    <div class=\"grid gap-6 split\">\n      <div class=\"grid grid-flow-row gap-2 auto-rows-max\">\n        <Textfield\n          textarea\n          class=\"vertical-textarea\"\n          bind:value={$data.changelog}\n          label=\"Changelog\"\n          required\n          input$rows={10}\n        />\n        <ValidationMessage for=\"changelog\" let:messages={message}>\n          <span class=\"validation-message\">{message || ''}</span>\n        </ValidationMessage>\n      </div>\n      <div class=\"grid grid-flow-row gap-2 auto-rows-max\">\n        <span>Preview:</span>\n        {#await markdown(preview) then previewRendered}\n          <div class=\"markdown-content right\">{@html previewRendered}</div>\n        {/await}\n      </div>\n    </div>\n\n    <div class=\"grid grid-flow-row gap-2\">\n      <Textfield bind:value={$data.date} label=\"Date and Time\" required />\n      <ValidationMessage for=\"date\" let:messages={message}>\n        <span class=\"validation-message\">{message || ''}</span>\n      </ValidationMessage>\n    </div>\n\n    <div class=\"grid grid-flow-row gap-2\">\n      <Textfield bind:value={$data.link} label=\"Link\" required />\n      <ValidationMessage for=\"link\" let:messages={message}>\n        <span class=\"validation-message\">{message || ''}</span>\n      </ValidationMessage>\n    </div>\n\n    <div>\n      <Button variant=\"outlined\" type=\"submit\">{submitText}</Button>\n    </div>\n  </div>\n</form>\n\n<style lang=\"postcss\">\n  .split {\n    grid-template-columns: 50% 50%;\n\n    & .right {\n      max-height: 75vh;\n      overflow: auto;\n    }\n  }\n</style>\n"],"names":["zod.object","zod.string","zod.number","createForm","validator"],"mappings":"qfAaA,KAAM,IACJ,qMAEW,GAAmBA,GAAW,CACzC,QAASC,KAAa,MAAM,IAC5B,qBAAsBC,KACtB,kBAAmBD,KAAa,MAAM,IACtC,UAAWA,KACX,KAAMA,KAAa,MACnB,UAAWA,KACX,KAAMA,8BCiBkC,QAAW,wKAA7C,wCAAkC,QAAW,wDAOX,QAAW,wKAA7C,wCAAkC,QAAW,wDAOX,QAAW,wKAA7C,wCAAkC,QAAW,qEAMvB,qBAAA,8EACD,oBAAA,6EACG,uBAAA,g4BAGU,QAAW,wKAA7C,wCAAkC,QAAW,wDAeT,QAAW,wKAA7C,wCAAkC,QAAW,mGAMF,wKAA3C,2CAA2C,6GAQX,QAAW,wKAA7C,wCAAkC,QAAW,wDAOX,QAAW,wKAA7C,wCAAkC,QAAW,qEAKL,kBAAA,yCAAA,8OApEnB,KAAM,4BAAN,KAAM,2HACkB,yBAAA,2HAMxB,KAAM,yCAAN,KAAM,qJAC+B,yBAAA,0GAMrC,KAAM,sCAAN,KAAM,+IAC4B,yBAAA,8HAMrC,KAAM,8BAAN,KAAM,+HAKuB,yBAAA,mJAajC,IAHA,KAAM,8BAAN,KAAM,+HAK6B,yBAAA,iIAMzC,GAAS,4EAOI,KAAM,yBAAN,KAAM,qHACe,yBAAA,oGAMrB,MAAM,yBAAN,KAAM,qHACe,yBAAA,yeAhBpC,+4BAAA,60BAjDd,SACE,OACE,6CAOA,+CAOA,+CAOA,+CAWA,OACE,+CAaA,OACE,wFAOJ,+CAOA,+CAOA,gHAnEyB,KAAM,iIAON,KAAM,+IAON,KAAM,oLAOT,KAAM,uIAeV,KAAM,uHAWZ,GAAS,kEAOI,KAAM,kIAON,KAAM,m5BAtFtB,eACA,iBACT,KAAM,GACN,kBAAmB,GACnB,KAAM,GACN,UAAW,GACX,qBAAsB,EACtB,UAAW,GAAmB,MAC9B,QAAS,QAEA,aAAa,kBAEhB,OAAM,QAASE,IACN,gBACf,QAASC,GAAW,IACpB,eAAgB,GAChB,SAAW,GAAyB,EAAS,GAAc,EAAM,wDASxC,EAAM,YAAN,GAAM,iDAON,EAAM,yBAAN,GAAM,+DAON,EAAM,sBAAN,GAAM,2DAOT,EAAM,cAAN,GAAM,oDAeV,EAAM,cAAN,GAAM,mDAkBC,EAAM,SAAN,GAAM,8CAON,EAAM,SAAN,GAAM,4LAnE9B,EAAW,EAAM,WAAwB"}