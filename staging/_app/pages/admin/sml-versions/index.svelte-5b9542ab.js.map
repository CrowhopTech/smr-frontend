{"version":3,"file":"index.svelte-5b9542ab.js","sources":["../../../../../../../src/routes/admin/sml-versions/index.svelte"],"sourcesContent":["<script lang=\"ts\">\n  import { DeleteSmlVersionDocument, GetSmlVersionsAdminDocument } from '$lib/generated';\n  import { mutation, operationStore, query } from '@urql/svelte';\n  import { writable } from 'svelte/store';\n  import PageControls from '$lib/components/utils/PageControls.svelte';\n  import { base } from '$app/paths';\n  import MetaDescriptors from '$lib/components/utils/MetaDescriptors.svelte';\n  import Card, { Content } from '@smui/card';\n  import DataTable, { Head, Body, Row, Cell } from '@smui/data-table';\n  import Button from '@smui/button';\n  import { prettyDate } from '$lib/utils/formatting';\n\n  // TODO Selectable\n  const perPage = 20;\n\n  const versions = operationStore(GetSmlVersionsAdminDocument, {\n    filter: {\n      offset: 0,\n      limit: perPage\n    }\n  });\n\n  const page = writable(1);\n  let totalVersions: number;\n\n  page.subscribe((p) => ($versions.variables.filter.offset = (p - 1) * perPage));\n\n  $: totalVersions = $versions?.data?.getSMLVersions?.count;\n\n  const deleteVersionMut = mutation({\n    query: DeleteSmlVersionDocument\n  });\n\n  const deleteVersion = (smlVersionID: string) => {\n    deleteVersionMut({ smlVersionID }).then(() => {\n      versions.reexecute();\n    });\n  };\n\n  query(versions);\n</script>\n\n<svelte:head>\n  <MetaDescriptors description=\"SML Versions\" title=\"Admin: SML Versions\" />\n</svelte:head>\n\n<div class=\"mb-5 ml-auto flex justify-between\">\n  <Button variant=\"outlined\" href=\"{base}/admin/sml-versions/new\">New SML Version</Button>\n\n  {#if totalVersions}\n    <div>\n      <PageControls totalPages={Math.ceil(totalVersions / perPage)} currentPage={page} />\n    </div>\n  {/if}\n</div>\n\n<Card>\n  {#if $versions.fetching}\n    <Content>Loading...</Content>\n  {:else if $versions.error}\n    <Content>Oh no... {$versions.error.message}</Content>\n  {:else}\n    <DataTable class=\"max-w-full\">\n      <Head>\n        <Row>\n          <Cell>Version</Cell>\n          <Cell>Stability</Cell>\n          <Cell>Satisfactory Version</Cell>\n          <Cell>Bootstrap Version</Cell>\n          <Cell>Release Date</Cell>\n          <Cell><!-- Buttons --></Cell>\n        </Row>\n      </Head>\n      <Body>\n        {#each $versions.data.getSMLVersions.sml_versions as version}\n          <Row>\n            <Cell>{version.version}</Cell>\n            <Cell>{version.stability}</Cell>\n            <Cell>{version.satisfactory_version}</Cell>\n            <Cell>{version.bootstrap_version}</Cell>\n            <Cell>{prettyDate(version.created_at)}</Cell>\n            <Cell>\n              <div class=\"grid grid-flow-col gap-4\">\n                <Button variant=\"outlined\" on:click={() => deleteVersion(version.id)}>Delete</Button>\n                <Button variant=\"outlined\" href={base + '/admin/sml-versions/' + version.id + '/edit'}>Edit</Button>\n              </div>\n            </Cell>\n          </Row>\n        {/each}\n      </Body>\n    </DataTable>\n  {/if}\n</Card>\n\n{#if totalVersions}\n  <div class=\"mt-5 ml-auto flex justify-end\">\n    <div>\n      <PageControls totalPages={Math.ceil(totalVersions / perPage)} currentPage={page} />\n    </div>\n  </div>\n{/if}\n"],"names":[],"mappings":"w0BA+CkE,+BAAA,8GAIlC,KAAK,KAAK,KAAgB,eAAuB,kHAD7E,gEAC4B,KAAK,KAAK,KAAgB,siCAc1C,uBAAA,gFACA,yBAAA,kFACA,oCAAA,6FACA,iCAAA,0FACA,4BAAA,suDAOG,KAAQ,mFAAR,KAAQ,yDACR,KAAQ,qFAAR,KAAQ,2DACR,KAAQ,gGAAR,KAAQ,sEACR,KAAQ,6FAAR,KAAQ,mEACR,EAAW,KAAQ,uFAAnB,EAAW,KAAQ,4EAGgD,sBAAA,+EACiB,oBAAA,kPAAtD,EAAO,uBAAyB,KAAQ,GAAK,oRAFhF,0IAEmC,EAAO,uBAAyB,KAAQ,GAAK,u/DAV/E,KAAU,KAAK,eAAe,kCAAnC,6PAAK,KAAU,KAAK,eAAe,+BAAnC,6HAAA,8DAAA,2qBAda,KAAU,MAAM,4BAA1B,gCAAA,oEAAU,KAAU,MAAM,gFAF1B,0BAAA,wHADN,MAAU,WAEL,KAAU,4XAsCU,KAAK,KAAK,KAAgB,eAAuB,iPAF/E,SACE,8DAC4B,KAAK,KAAK,KAAgB,iQAlDtB,8EAE7B,4EA6CF,meAhDL,mKAGO,4JA6CF,sWAjFG,GAAU,iCAEV,GAAW,GAAe,IAC9B,QACE,OAAQ,EACR,MAAO,8BAIL,GAAO,GAAS,MAClB,GAEJ,EAAK,UAAW,QAAO,EAAU,UAAU,OAAO,OAAU,GAAI,GAAK,WAI/D,GAAmB,IACvB,MAAO,KAGH,EAAiB,IACrB,GAAmB,iBAAgB,UACjC,EAAS,eAIb,GAAM,cA4CmD,EAAc,EAAQ,8CAxD5E,EAAgB,GAAW,MAAM,gBAAgB"}